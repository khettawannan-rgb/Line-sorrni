/* ===== Fluid Container System v3.1 – Non-destructive ===== */
*, *::before, *::after { box-sizing: border-box; }
html, body { width: 100%; max-width: 100%; }
html { -webkit-text-size-adjust: 100%; }
body { margin: 0; overflow-x: hidden; min-height: 100dvh; }

/* Fluid tokens (no color changes) */
:root{
  --container-max: 1360px;          /* ดีต่อ 1280px (MacBook 13") */
  --container-max-wide: 1440px;
  --gutter: clamp(16px, 3.2vw, 32px);
  --gap: clamp(12px, 2vw, 24px);
  --card-min: 320px;
  --app-header-h: 64px;              /* fallback จะถูก JS sync ให้อัตโนมัติ */
}

/* Centered container for all pages */
:where(main, .main, .page, .page-content, .content, .dashboard, .app-shell){
  width: min(100%, var(--container-max));
  margin-inline: auto;
  padding-inline: var(--gutter);
}
@media (min-width: 1600px){
  :where(main, .main, .page, .page-content, .content, .dashboard, .app-shell){
    width: min(100%, var(--container-max-wide));
  }
}

/* Media & tables never overflow */
:where(img, svg, canvas, video){ max-width: 100%; height: auto; display: block; }
:where(table, .table, .data-grid){ display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; }

/* Login/Auth: perfectly centered + safe on iOS */
:where(.login, .auth, .login-page, .auth-page){
  min-height: 100dvh;               /* modern */
  min-height: -webkit-fill-available; /* iOS fallback */
  display: grid;
  align-content: center;
  justify-items: center;
  padding-block: clamp(24px, 6vh, 64px);
}
:where(.login .card, .auth .card, .auth-card, .login-card, form.login, form.auth){
  width: min(100%, 560px);
  margin-inline: auto;
}

/* Hide decorative right column < 1600px for all relevant pages */
@media (max-width: 1600px){
  :where(.auth [class*="promo"], .auth [class*="banner"], .login [class*="promo"], .login [class*="banner"],
         .auth [class*="right"], .login [class*="right"], .auth [class*="aside"], .login [class*="aside"],
         .dashboard [class*="promo"], .dashboard [class*="right"], .dashboard [class*="aside"]) {
    display: none !important;
  }
}

/* Sidebar layout */
:where(.layout, .app-layout, .shell){
  display: grid;
  grid-template-columns: minmax(0, 1fr); /* mobile-first */
  gap: var(--gap);
}
@media (min-width: 1024px){
  :where(.layout.with-sidebar, .app-layout.with-sidebar, .shell.with-sidebar,
         .layout.has-sidebar, .shell.has-sidebar){
    grid-template-columns: 260px minmax(0, 1fr);
    align-items: start;
  }
}
.sidebar{ position: sticky; top: calc(var(--app-header-h, 64px) + env(safe-area-inset-top)); max-width: 100%; }

/* KPI/Card grids */
:where(.cards, .card-grid, .widgets, .kpi-grid, .dashboard-cards){
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--card-min)), 1fr));
  gap: var(--gap);
}
/* Make 1280–1440 nicely filled (3 cols typical on MacBook 13") */
@media (min-width:1200px) and (max-width:1440px){
  :where(.cards, .card-grid, .widgets, .kpi-grid, .dashboard-cards){
    grid-template-columns: repeat(3, minmax(0,1fr));
  }
}

/* Vertical rhythm */
:where(section, .section, .page-header, .group, .stack){ margin-block: clamp(16px, 4vh, 40px); }

/* Guard against 100vw/full-bleed culprits */
[style*="width: 100vw"], .w-100vw, .full-bleed{ width:100% !important; max-width:100% !important; }
:where(.bg, .background, .decor, .gradient, [class*="gradient"]){ max-width:100%; overflow:clip; pointer-events:none; }

/* Buttons full-width on small screens (no color changes) */
:where(form .field, form .input, .btn, .button){ min-width: 0; }
@media (max-width:768px){ :where(.btn, .button){ width: 100%; } }

/* Cards safety */
:where(.card, .panel, .widget, .box){ overflow: hidden; border-radius: inherit; }

/* Brand fallbacks (only when needed—see JS toggling) */
.brand-logo.is-bg-fallback{ background:center/contain no-repeat url("/static/img/sorni.png"); }
.brand-logo.is-bg-fallback img{ opacity:0; width:0; height:0; }
.auth-brand.is-bg-fallback{ background:center/contain no-repeat url("/static/img/sorni.png"); }
.auth-brand.is-bg-fallback img{ opacity:0; width:0; height:0; }

/* Scope uppercase to the intended wordmark only */
.brand-name[data-word="sorrni"]{ text-transform: uppercase; }
