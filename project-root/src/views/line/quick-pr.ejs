<section class="lite-wrapper">
  <header class="lite-header">
    <h1>สร้างใบขอซื้อแบบรวดเร็ว</h1>
    <p>กรอกข้อมูลผู้ขายและสินค้าไม่กี่รายการ เพื่อบันทึก PR (Draft) ผ่าน LINE ได้ทันที</p>
  </header>

  <% if (errors && errors.length) { %>
    <div class="lite-alert danger">
      <% errors.forEach((err) => { %>
        <div><%= err %></div>
      <% }) %>
    </div>
  <% } %>

  <% if (result && result.success) { %>
    <div class="lite-alert success">
      สร้าง PR เรียบร้อยแล้ว:
      <strong><a href="/admin/pr/<%= result.pr._id %>" target="_blank" rel="noopener"><%= result.pr.prNumber %></a></strong>
      <div style="margin-top:8px;">
        <a href="/admin/pr/<%= result.pr._id %>?guest=1" target="_blank" rel="noopener">เปิดดูใน NILA Admin</a>
      </div>
    </div>
  <% } %>

  <form method="post" action="/line/forms/quick-pr" class="lite-form">
    <label>
      ผู้ขอ
      <input name="requester" placeholder="ชื่อผู้ขอ" value="<%= form.requester || '' %>" />
    </label>
    <label>
      ผู้ขาย
      <select name="vendorId" required>
        <option value="">เลือกผู้ขาย...</option>
        <% vendors.forEach((vendor) => { %>
          <option value="<%= vendor._id %>" <%= String(form.vendorId) === String(vendor._id) ? 'selected' : '' %>><%= vendor.name %></option>
        <% }) %>
      </select>
    </label>

    <h2>รายการสินค้า</h2>
    <label>
      รายการ 1
      <input name="line1Desc" placeholder="สินค้า/บริการ" value="<%= form.line1Desc || '' %>" />
    </label>
    <div class="lite-grid">
      <label>
        จำนวน
        <input name="line1Qty" type="number" step="0.01" value="<%= form.line1Qty || '' %>" />
      </label>
      <label>
        ราคา/หน่วย
        <input name="line1Price" type="number" step="0.01" value="<%= form.line1Price || '' %>" />
      </label>
      <label>
        หน่วย
        <input name="line1Uom" value="<%= form.line1Uom || 'EA' %>" />
      </label>
    </div>

    <label>
      รายการ 2 (ถ้ามี)
      <input name="line2Desc" placeholder="สินค้า/บริการ" value="<%= form.line2Desc || '' %>" />
    </label>
    <div class="lite-grid">
      <label>
        จำนวน
        <input name="line2Qty" type="number" step="0.01" value="<%= form.line2Qty || '' %>" />
      </label>
      <label>
        ราคา/หน่วย
        <input name="line2Price" type="number" step="0.01" value="<%= form.line2Price || '' %>" />
      </label>
      <label>
        หน่วย
        <input name="line2Uom" value="<%= form.line2Uom || 'EA' %>" />
      </label>
    </div>

    <label>
      หมายเหตุ
      <textarea name="notes" rows="3" placeholder="รายละเอียดเพิ่มเติม (ถ้ามี)"><%= form.notes || '' %></textarea>
    </label>

    <button type="submit" class="lite-submit">บันทึก PR เป็น Draft</button>
  </form>
</section>
